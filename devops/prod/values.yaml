iam-cache-server-helm:
  replicaCount: 3

  image:
    repository: "984870885661.dkr.ecr.us-west-2.amazonaws.com/ics-api"
    pullPolicy: IfNotPresent
    # Overrides the image tag whose default is the chart appVersion.
    tag: "latest"

  imagePullSecrets: [ ]
  nameOverride: "ics"
  fullnameOverride: "ics"

  serviceAccount:
    # Specifies whether a service account should be created
    create: true
    # Annotations to add to the service account
    annotations: { }
    # The name of the service account to use.
    # If not set and create is true, a name is generated using the fullname template
    name: ""

  podAnnotations: { }

  podSecurityContext: { }
  # fsGroup: 2000

  securityContext: { }
    # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

  service:
    type: NodePort
    port: 3000

  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: alb
      alb.ingress.kubernetes.io/scheme: internet-facing
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS":443}]'
      alb.ingress.kubernetes.io/actions.ssl-redirect: '{"Type": "redirect", "RedirectConfig": { "Protocol": "HTTPS", "Port": "443", "StatusCode": "HTTP_301"}}'
      alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-west-2:984870885661:certificate/918cc751-460e-4e4f-bec0-61fac1e02124
    hosts:
      - host: identitycache.energyweb.org
        paths:
          - path: "/"
            pathType: Prefix
            backend:
              service:
                name: ssl-redirect
                port:
                  name: use-annotation
          - path: "/"
            pathType: Prefix
            backend:
              service:
                name: ics
                port:
                  number: 80
      - host: ewc-identitycache.energyweb.org
        paths:
          - path: "/"
            pathType: Prefix
            backend:
              service:
                name: ssl-redirect
                port:
                  name: use-annotation
          - path: "/"
            pathType: Prefix
            backend:
              service:
                name: ics
                port:
                  number: 80
    tls: [ ]

  config:
    secretRefName: ics-secrets
    configRefName: ics-cm

  appValues:
    CHAIN_ID: 246
    CHAIN_NAME: ewc
    NATS_ENVIRONMENT_NAME: ewf-prod
    PUBLIC_RESOLVER_ADDRESS: 0xA517983Bd4Af4DF0Ed9b52DA4BC405d0A95eE7E2
    ENS_REGISTRY_ADDRESS: 0x0A6d64413c07E10E890220BBE1c49170080C6Ca0
    ROOT_DOMAIN: auth.ewc
    DID_REGISTRY_ADDRESS: 0xE29672f34e92b56C9169f9D485fFc8b9A136BCE4
    CLAIM_MANAGER_ADDRESS: 0x23b026631A6f265d17CFee8aa6ced1B244f3920C
    DOMAIN_NOTIFIER_ADDRESS: 0x5491Db3cC1f3AFf6C229e061735F92936004da3c
    RESOLVER_V1_ADDRESS: 0x70ad37DfeB1C05290F4bBd22188FA19Bc154A0ea
    RESOLVER_V2_ADDRESS: 0x70ad37DfeB1C05290F4bBd22188FA19Bc154A0ea
    ASSETS_MANAGER_ADDRESS: 0x2d1569f3a2006d21c0dc60eb13c8557b63ce5a8d
    ASSETS_SYNC_INTERVAL_IN_HOURS: 10
    ASSETS_SYNC_HISTORY_INTERVAL_IN_HOURS: 21
    ASSETS_SYNC_ENABLED: true
    DIDDOC_SYNC_INTERVAL_IN_HOURS: 12
    DID_SYNC_ENABLED: true
    DID_SYNC_MODE_FULL: false
    ENS_SYNC_INTERVAL_IN_HOURS: 11
    ENS_SYNC_ENABLED: true
    ENABLE_AUTH: true
    JWT_PRIVATE_KEY: /app/private.pem
    JWT_PUBLIC_KEY: /app/public.pem
    STRATEGY_CACHE_SERVER: https://identitycache.energyweb.org/v1
    STRATEGY_NUM_BLOCKS_BACK: 10
    JWT_ACCESS_TOKEN_EXPIRES_IN: 15m
    JWT_REFRESH_TOKEN_EXPIRES_IN: 1h
    JWT_ACCESS_TOKEN_NAME: token
    JWT_REFRESH_TOKEN_NAME: refreshToken
    STATUS_LIST_DOMAIN: https://identitycache.energyweb.org/v1
    CHAIN_REQUEST_ATTEMPTS: 5

  opsValues:
    DB_NAME: ics
    NODE_ENV: production
    UNIVERSAL_RESOLVER_URL: https://dev.uniresolver.io/10/identifiers/
    NATS_VERSION: 2.1.8
    NATS_CLIENTS_URL: iam-cache-server-nats.ics.svc.cluster.local:4222
    LOGS_DIRECTORY: /app/logs
    NESTJS_PORT: 3000
    SENTRY_ENV: prod
    IPFS_CLIENT_PORT: 5001
    IPFS_CLIENT_PROJECT_ID: 2DFVKQS7MfgeN9hdXrPG6HHH02O
    IPFS_CLIENT_HOST: ipfs.infura.io

  resources:
    limits:
      cpu: 750m
      memory: 800Mi
    requests:
      cpu: 500m
      # High memory request is due to DIDKit usage https://github.com/spruceid/didkit/issues/301
      # We anticipate memory usage to decrease once node v18 is used
      memory: 700Mi

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 6
    targetCPUUtilizationPercentage: 50
    targetMemoryUtilizationPercentage: 85

  nodeSelector: { }

  tolerations: [ ]

  #matchLabels are taken from helpers "iam-cache-server-helm.selectorLabels"
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/instance: iam-cache-server
                app.kubernetes.io/name: ics
            topologyKey: "kubernetes.io/hostname"

  sealedSecret:
    enabled: true
    annotations: { }
    encryptedData:
      STRATEGY_PRIVATE_KEY: AgA1+L2/8PWywueMFu3RSreTkt3GR+SZP5bYF7e3N3RUQ82t5M3Eigp5lEHKh2guPmIn1qsENOfA/KOsCkgGX5kjBrTN9bTMTeqlDF6yBSFUnVhlv3AAZur+rvCaKdm/S0HtGzfEN5lnVjbPYOUgxt0nStd6Z4zVMQvddYfwnuDUg0o/Zckm67FF3S9wVLv+xokn0gRYEYqtUWqtB/LYNDEWiAhgkZJtnBsA44J2xbRS5v6uOhKk7b0N0Y3JxdeAGSTrtY70by9GkOp60zAz+Pmx1QEv6wOPUjEw0h97uLR21JoSgnxSolpr3GPJ/ZVvtGuUi03tF5KhOTeu7tEyeNHAa/Ltwe9i4Bss4dvrWW+f8pVjkX/zLZS9IkM3zxiPAIQymeXtd8MyRedaygXaC2oU/CmRMYoXPOcwvPW2n3p6rmWi2IVrUx5NKSfdDKi1cp/OrQR08iL/77Bt1T4vhjouqwhtz70mAYGndDnFSy1+aD3NaWFBrEvNaeM/qa+eqUEtqnawJ3iT+0dbEyoIfVuDorP9sSYLvJ7AxvD8RWDnPuYFq1pVsgV2XD23q/i8fjkaIm3R8vFdlbQsMW/CUz1ZsgbbsK3iAnbOf+pbuUazRTZLDpYYTNnNnKmEHwhxLYsE1x2ZEMbitOqv/SOEeSNH82N/Y7cjV00lAPIdIi1J5R4uAURW5ZbjGVDxq5Jepr/UIFf9WtCZiwgUVT+r4ZymRCkPSApEmR4ouPg5zHyhmjqP4dBdE6H2Zy8bWdPhf5yHR+Abfzx8+QoJpXjOs9I6
      SENTRY_DNS: AgAaSjcMu20j5h9wcj7AkQs16cdXMfQNhqtPNnaExevpV0vtokuYKetgYe13W5JTFnQwfYQMrrikHOaqicd1GwuYlkd0gxVP/LOzrdZ1fs/crhCKuO/2QuMQz6r1fPV618Ds6NExAG957e1DaVDlL3B1q9PZQaJl5cadajm4zpwrFVRYmc4Ta6AUXa7AMviguq+CVdvf/Kt+Mrf2r0+Ml5S33yQpPgsJWqvsnS2+FuTKbeWHkEXG94sTRKix33bX2eZ2ss7/wJt+/f/CI6aI83EOM0nTxZihXKwy9AXnlu+S17oZWI1U3N8O2MLkGcEWPVETwdUG+KmhS8SmtDHywe7ZDTBL0dI9dfJBKfYU5UWbN3/KIMtLvmAO3yp36l9SqrauvFScANNBy7CdR80j9n0Yi6WoVDBAb4o+4cXm1tMt+pOHgKobeYkoKMfam1g2UocDXNmlbh0gBQPFbeemSYv84uVNjJDLuRqJxP6avmQEwezms9psTtiJlooTCItD/SiReZzM71vH8ZIQZNzyxgb6WBj1l/qsQ00xpxl5d6i9WbtZhA/QlJNoT4M6z96vSVA/pyKdwbgeukmW/G3PiHkoET47rNxC22pL13bBKO60c93AG6DTwNjzbXF71pVjZnMUVjAnoj3KaCA/RjaT/H14NB8gxlOmcS8L6IgwcojEygA+/e/pneKE2/DfGOz5ZaRBppf9Khbs7B46mFaj54mcBZIxJ7hYoZS9tWV17Bgn5oQi+zddE+3tFpG6WJLHgaFPwKVjF2aECHUfbDL4j+m/DL3NBrkp9kt4aA==
      IPFS_CLIENT_PROJECT_SECRET: AgArTH7sPUNO1gI4NH/ypIIWWMx6eQJBp65NJjF4dwt4jRU6EaHHgjlk4LyfDfaxWBHPl8zemtt6QqtDAKXeQyoQ3aeZd35NFNmRUYLmJpYSfiyctS2pyEfMp8yyaJCKGjtYH6omJq/3Zt6Fy/eBW4FsYEyYADU67yFMGApeDu+T+TZKTZGhM6cfF4fS7kuPMsHoT10rBkJSksHqvucwZdgv+I7bPNMjc9EOke5wc5VuecJnGZLOfxNoWapaX3z0Ml8Hdgtd+yR/uJUL5zIHd/PzaQePYWTTQRoVdyi/kLqSmo1OXTolX9tVi3AR1XUYynMRTuwyNXAUkHawQccvrbo6boG5IMKShQhSJwi6ulJHPyrhW3lwY7wqz+MREO33orpemWj6oSKTySkODaKM6KBznuSlgg0HfQSp3Ja8b/IZVcO6siuAbDpbYZt/Yizv/wKy33qJadsGByHTBdikPm53sOQgmmGFaLRWtJ9jKSc5ECChDgy5hQPdNjz55AH48cl+Oqag+ky5ZUCYY3SoC5pjtzjAXEmo2yteJA/QFsOVAcXzNKQUL1A9kSCJKFzEgN2OB+um+W+godPoaRfXOXAFw+FxvbA0AsoYHPzl0eopfg+iyLH7Lata+e2QMqielMHfF7KR8jcrhk2hxx4WTA/lfHd4e0SvgF7iujpV3cE28BvG9ZZDqmpvHPazaxbeKxpj3wzqyUEBLGPomfnkXZoJ3YBR4SG2rDOqjEQHa84v+w==
      ENS_URL: AgBoXgF+veIAYSQRVN5mq5Q189utr0bxHXjOVSzAu/cfEmBJyH/q0DdCMCjkKILypNTAcQaLqbsVixZy4qVl14vs6LPYeKyLsgZ9CXrz0dffeogHX88+PJYgcGnfVhhsjBwGvToBz9adgCPv030dVEwz+HYRFhIayz/Mnubs0CLzkAEDdQiOW6u7JBNNyw0q7CMPW1Z0HDroYVR/zNAZJHAmSpsmKSiiHnJw2LO0JMJ6YLkHRZRuNPR1Yu4D05l3vPk+1YNk7t2Eca05fTfiH6n3KlW69Zl6F48uGumpJM2ME4WI36lFclB+c5T22mOWi+lx3ZW9ypJei/pp/sjnTTAgnboKC5GPI6LAbi1/VaZzDcdbWDJ18dOHXuz0MkgTTcSsRBFM2edxzWwSTWe8JJqOTxZq84ljefv3p/7GAXZ/ZCEa1PBA1RDuJ22h1ibMvSO696RuqqYh64H9KHzcTDuFzbjqr0osbP9bovIWDPNcQFDX8vF4SZkbnTHvbWV/KK9k1i+SNKJyQ9FOBFcLKLGD7FI2G1VEKRtzzxuXWEp9OMa9qx7pabxmSKgzaSXhdYw0klNzguZx3enpC1tMv0p+eQ44qa0GA22q3C1oYjJqxrVFQyxnhgPd+WS03iH00kAraqJsR5rHYjcuoIXvbcYVnPm0Zs7/4Km5r0+nnwJTg5W3IDoevbX9mLejnd08e7YmyDqkJlPFL8zeGw8ondQ98aGvfsQan9w3ukBZDeWsgVX/K7Jmnh0=
